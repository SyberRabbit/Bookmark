name: Sync Gitee Bookmarks

on:
  schedule:
    - cron: "0 2 * * *"  # æ¯å¤©å‡Œæ™¨ 2 ç‚¹ï¼ˆUTC æ—¶é—´ï¼‰è‡ªåŠ¨åŒæ­¥
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  update-bookmark:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸš€ æ£€æŸ¥ GitHub ä»“åº“
        uses: actions/checkout@v3

      - name: ğŸ”„ ä¸‹è½½ Gitee ä¹¦ç­¾æ–‡ä»¶
        run: |
          curl -L -o Edge-bookmarks.html "https://gitee.com/sola929/bookmark/raw/master/Edge-bookmarks.html"

      - name: ğŸ” æ£€æŸ¥æ˜¯å¦æœ‰æ›´æ”¹
        run: |
          git diff --quiet && git diff --staged --quiet || echo "Changes detected"

      - name: Set up Git
        run: |
          git config --global user.name "github-actions"
          git config --global user.email "github-actions@github.com"

      - name: Authenticate with GitHub
        run: |
          git remote set-url origin https://x-access-token:${{ secrets.GH_PAT  }}@github.com/funnymapi/Bookmark.git

      - name: Push changes
        run: |
          git add Edge-bookmarks.html
          git commit -m "ğŸ”„ è‡ªåŠ¨åŒæ­¥ Gitee ä¹¦ç­¾æ–‡ä»¶ $(date +'%Y-%m-%d %H:%M:%S')" || echo "No changes to commit"
          git push origin main
